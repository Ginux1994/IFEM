<?xml version="1.0" encoding="UTF-8" standalone="yes"?>

<!-- 3D Contact between a hyperelastic box and a rigid plane. !-->
<!-- Q1/P0 mixed finite elements. Penalty contact formulation. !-->

<simulation>

  <geometry>
    <patchfile>cube20x20x20.g2</patchfile>
    <refine patch="1" u="1" v="1" w="1"/>
    <topologysets>
      <set name="lower" type="face">
        <item patch="1">5</item>
      </set>
      <set name="upper" type="face">
        <item patch="1">6</item>
      </set>
      <set name="upperLeft" type="edge">
        <item patch="1">3</item>
      </set>
      <set name="upperLeftBack" type="vertex">
        <item patch="1">5</item>
      </set>
    </topologysets>
  </geometry>

  <boundaryconditions>
    <dirichlet comp="1" set="upperLeftBack"/>
    <dirichlet comp="2" set="upperLeft"/>
    <dirichlet comp="3" set="upper" type="linear">-1.0</dirichlet>
  </boundaryconditions>

  <finitedeformation>
    <formulation>
      <mixed type="Qp/Pp-1">0</mixed>
    </formulation>
    <isotropic version="23" K="400942.0" G="80.1938"/>
    <contact formulation="penalty">
      <plane>
        <point> 10.0 -10.0 -9.0</point>
        <point> 10.0  10.0 -9.0</point>
        <point>-10.0 -10.0 -9.0</point>
        <slave set="lower"/>
        <dirichlet comp="123"/>
        <eps value="1.0e6"/>
      </plane>
    </contact>
  </finitedeformation>

  <discretization>
    <nGauss>2</nGauss>
  </discretization>

  <nonlinearsolver>
    <timestepping>
      <step start="0.0" end="5.0">0.0 1.0</step>
    </timestepping>
    <rtol>1.0e-16</rtol>
  </nonlinearsolver>

  <postprocessing>
    <vtfformat nviz="5">BINARY</vtfformat>
  </postprocessing>

</simulation>
